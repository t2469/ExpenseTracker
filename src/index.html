<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        input { margin: 5px 0; width: 100%; padding: 8px; }
        button { padding: 10px 20px; margin-top: 10px; }
    </style>
</head>
<body>
<h3>支出入力</h3>
<label for="category">カテゴリ:</label>
<input type="text" id="category" placeholder="例: 食費">
<label for="amount">金額:</label>
<input type="number" id="amount" placeholder="例: 1000">
<button onclick="submitExpense()">保存</button>

<script>
    function submitExpense() {
        const category = document.getElementById('category').value;
        const amount = document.getElementById('amount').value;
        if (category && amount) {
            google.script.run.withSuccessHandler(function(){
                alert('支出が保存されました');
                document.getElementById('category').value = '';
                document.getElementById('amount').value = '';
            }).saveExpense(category, Number(amount));
        } else {
            alert('カテゴリと金額を入力してください');
        }
    }
</script>
</body>
</html>
